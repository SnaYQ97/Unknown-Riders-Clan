/*!
 * Start Bootstrap - SB Admin 2 v4.0.7 (https://startbootstrap.com/template-overviews/sb-admin-2)
 * Copyright 2013-2020 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

$(document).ready(function(){function s(){try{Request=new XMLHttpRequest}catch(t){Request=!1}return Request}$("#example tbody ").on("click","#showMore",function(){var t,a=$(this).closest("tr"),e=a.last("i.fas"),d=a.find("span.text i.fas"),n=o.row(e);n.child.isShown()?(n.child.hide(),a.removeClass("shown"),d.last().removeClass("fa-chevron-up"),d.last().addClass("fa-chevron-down")):(n.child('<table class="table table-bordered table-hover" cellpadding = "5" cellspacing = "0" border = "0" style = "padding-left:50px;"><tr><th>Preview</th><th>Add Date</th><th>Added By</th></tr><tr><td class="d-flex flex-row justify-content-center align-items-center"><img style="max-width: 480px; max-height: 268px;" src='+(t=n.data()).link+"></td><td>"+t.add_date+"</td><td>"+t.add_by+"</td></tr></table>").show(),a.addClass("shown"),d.last().removeClass("fa-chevron-down"),d.last().addClass("fa-chevron-up"))}),$("#exampleModal #link").on("paste",function(){var a=this;setTimeout(function(){var t=$(a).val();$("#exampleModal #preview").attr("src",t)},100)}),$("#EditModal #link").on("paste",function(){var a=this;setTimeout(function(){var t=$(a).val();$("#EditModal #preview").attr("src",t)},100)});var o=$("#example").DataTable({ajax:"http://unknownriders.pl/adminpanel/index.php/PhotosController/createAjax",columns:[{data:"id"},{data:"link"},{data:"author",searchable:!1},{className:"details-control dt-center",orderable:!1,searchable:!1,data:null,defaultContent:'<div class="d-flex flex-row justify-content-center align-items-center td.details-control"><button class="btn btn-danger btn-icon-split mx-2 btn-sm" id="delete"><span class="text"><i class="fas fa-trash"></i></span></button><button class="btn btn-success btn-icon-split mx-2 btn-sm" id="show_edit_modal" data-toggle="modal" data-target="#EditModal"><span class="text"><i class="fas fa-pen"></i></span></button><button class="btn btn-info btn-icon-split mx-2 btn-sm" id="showMore"><span class="text"><i class="fas text-light fa-chevron-down"></span></button></div>'}],order:[[0,"desc"]]});$("#example tbody ").on("click","#show_edit_modal",function(){var t=$(this).closest("tr").first("i.fas"),a=o.row(t);$("#EditModal #preview").attr("src",a.data().link),$("#EditModal #preview").attr("alt",a.data().link),$("#EditModal #link").val(a.data().link),$("#EditModal #author").val(a.data().author),$("#EditModal #added_by").val(a.data().add_by),$("#EditModal #added_date").val(a.data().add_date),id=o.row(t).data().id,$("#save_edit").on("click",function(){var t=$("#EditModal #link").val(),a=$("#EditModal #author").val(),e=$("#EditModal #added_by").val(),d=$("#EditModal #added_date").val(),n="id="+id+"&link="+t+"&author="+a+"&addby="+e+"&adddate="+d,l=new s;l.open("POST","http://unknownriders.pl/adminpanel/index.php/PhotosController/updatePhoto",!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.send(n),l.onreadystatechange=function(){4==this.readyState&&(200==this.status?(o.ajax.reload(),$("#EditModal #link").val(""),$("#EditModal #author").val(""),$("#EditModal #added_by").val(""),$("#EditModal #added_date").val("")):alert("Błąd komunikacji z serwerem: E:Con.Status "+this.statusText))}}),$("#cancel_edit").on("click",function(){$("#EditModal #link").val(""),$("#EditModal #author").val(""),$("#EditModal #added_by").val(""),$("#EditModal #added_date").val("")})}),$("#example tbody ").on("click","#delete",function(){var t=$(this).closest("tr"),a=t.first("i.fas");t.find("span.text i.fas"),o.row(a);t.find("td.details-control").children().html("<button class='btn btn-success btn-icon-split mx-2 btn-sm' id='confirm'><span class='text'><i class='fas fa-check'></i></span></button><button class='btn btn-warning btn-icon-split mx-2 btn-sm' id='cancel'><span class='text'><i class='fas fa-times'></i></span></button>"),$("#example tbody ").on("click","#confirm",function(){var t=$(this).closest("tr").first("i.fas"),a="id="+o.row(t).data().id,e=new s;e.open("POST","http://unknownriders.pl/adminpanel/index.php/PhotosController/deletePhoto",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send(a),e.onreadystatechange=function(){4==this.readyState&&(200==this.status?(o.ajax.reload(),$("#exampleModal #link").val(""),$("#exampleModal #author").val("")):alert("Błąd komunikacji z serwerem: E:Con.Status "+this.statusText))}}),$("#example tbody ").on("click","#cancel",function(){o.ajax.reload()})}),$("#add").on("click",function(){var t="link="+$("#link").val()+"&author="+$("#author").val()+"&addby="+$("#user_nick").text(),a=new s;a.open("POST","http://unknownriders.pl/adminpanel/index.php/PhotosController/addPhoto",!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(t),a.onreadystatechange=function(){4==this.readyState&&(200==this.status?o.ajax.reload():alert("Błąd komunikacji z serwerem: E:Con.Status "+this.statusText))}})});